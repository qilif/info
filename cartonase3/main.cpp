#include <iostream>
using namespace std;
//ifstream cin ("cartonase.in");
//ofstream cout ("cartonase.out");
int main()
{
    long long c,n,a,b,x,i=0,j=1,mai=0;
    bool z=false;
    cin>>c>>n>>a>>b;
    x=b;
    n--;
    if(c==1)
    {
        while(n)
        {
            cin>>a>>b;
            if(x==a)
                i++;
            x=b;
            n--;
        }
        cout<<i;
    }
    else if(c==2)
    {
        mai=1;
        while(n)
        {
            cin>>a>>b;
            if(a==x)
                i++;
            else
                i=0;
            if(i>mai)
                mai=i;
            else if(i==mai)
                z=true;
            x=b;
            n--;
        }
        if(mai==1)
        {
            cout<<'0';
            return 0;
        }
        cout<<mai+1;
    }
    else
    {
        i=1;
        while(n)
        {
            cin>>a>>b;
            if(a==x)
                i++;
            else
                i=1;
            if(i==mai)
                j++;
            else if(i>mai)
            {
                mai=i;
                j=1;
            }
            x=b;
            n--;
        }
        if(mai==1&&!z)
        {
            cout<<'0';
            return 0;
        }
        cout<<j;
    }
    return 0;
}
/*
2
99
499 592
159 382
375 108
863 60
704 594
296 973
706 451
64 645
356 723
137 878
915 600
27 105
204 903
225 964
931 984
20 372
29 251
809 266
476 553
44 486
789 656
719 591
654 609
146 250
61 264
123 24
244 334
233 179
171 651
396 926
686 418
392 155
48 901
89 241
579 384
300 584
956 188
988 497
465 821
146 646
938 47
285 110
520 311
42 843
756 759
841 989
753 54
537 864
131 627
153 38
84 796
242 727
683 753
815 152
743 866
133 637
375 317
496 732
559 91
376 539
51 753
386 683
951 632
437 170
674 833
582 715
17 115
703 214
474 439
540 746
123 846
794 953
981 243
446 12
998 958
579 822
571 285
479 858
726 222
490 261
102 53
782 855
29 983
543 867
260 60
122 995
661 991
248 50
992 318
254 392
502 922
624 783
859 327
196 891
549 410
527 658
462 940
784 169
169 976
*/
